!function(t){function e(e){for(var r,i,c=e[0],l=e[1],u=e[2],p=0,f=[];p<c.length;p++)i=c[p],o[i]&&f.push(o[i][0]),o[i]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(t[r]=l[r]);for(s&&s(e);f.length;)f.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],r=!0,c=1;c<n.length;c++){var l=n[c];0!==o[l]&&(r=!1)}r&&(a.splice(e--,1),t=i(i.s=n[0]))}return t}var r={},o={3:0},a=[];function i(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=r,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="";var c=window.webpackJsonp=window.webpackJsonp||[],l=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var s=l;a.push([0,1,0]),n()}({0:function(t,e,n){n("201c"),t.exports=n("d/w2")},"d/w2":function(t,e,n){"use strict";n.r(e);n("VxdY");var r=n("/MKj"),o=n("q1tI"),a=n.n(o),i=n("i8i4"),c=n("MBKY"),l=n("XOpu"),u=n("zGKU");function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function b(t,e){return(b=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var d=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=f(this,y(e).call(this,t))).state={error:null,service:null,status:"creating"},t.intents.createService().then(function(t){return n.setState({status:"created",service:t})}).catch(function(t){return n.setState({error:t,status:"errored"})}),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&b(t,e)}(e,o["Component"]),n=e,(r=[{key:"render",value:function(){var t=this.props,e=t.appData,n=t.children,r=t.t,i=this.state,c=i.error,l=i.service,s=i.status,p=l&&l.getIntent(),f=p&&o.Children.toArray(n).find(function(t){var e=t.props,n=e.action,r=e.type;return n===p.attributes.action&&r===p.attributes.type});return a.a.createElement("div",{className:"coz-intent"},"creating"===s&&a.a.createElement(u.a,{size:"xxlarge"}),c&&a.a.createElement("div",{className:"coz-error coz-intent-error"},a.a.createElement("p",null,r("intent.service.creation.error.title")),a.a.createElement("p",null,c.message)),f&&a.a.cloneElement(f,{appData:e,compose:l.compose,data:l.getData(),intent:l.getIntent(),onCancel:function(){return l.cancel()},onError:function(t){return l.throw(t)},onTerminate:function(t){return l.terminate(t)}}))}}])&&p(n.prototype,r),i&&p(n,i),e}(),h=Object(l.e)()(d),m=n("o0o1"),v=n.n(m),g=n("PShk"),E=n("7Z11"),O=n("/n/j");function w(t){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function j(t,e,n,r,o,a,i){try{var c=t[a](i),l=c.value}catch(t){return void n(t)}c.done?e(l):Promise.resolve(l).then(r,o)}function S(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function P(t){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _(t,e){return(_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function z(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var x={alreadyInstalledError:"intent.install.error.installed",fetchError:"intent.install.error.fetch",installError:"intent.install.error.install",appError:"intent.install.error.unavailable"},k=function(t){function e(t){var n,r,o,a,i,c;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,n=!(o=P(e).call(this,t))||"object"!==w(o)&&"function"!=typeof o?z(r):o,a=z(z(n)),c={status:""},(i="state")in a?Object.defineProperty(a,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[i]=c,t.initAppIntent(),n}var n,r,i,c,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_(t,e)}(e,o["Component"]),n=e,(r=[{key:"installApp",value:function(){var t=this.props,e=t.app,n=t.data,r=t.isInstalling,o=t.isFetching,a=t.fetchError;if(!r&&!o&&!a)return this.props.installApp(n.slug,e.type)}},{key:"componentWillReceiveProps",value:(c=v.a.mark(function t(e){var n,r,o,a,i,c;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.props.isInstalling||e.isInstalling){t.next=8;break}if(this.setState({status:"installed"}),n=this.props,r=n.app,o=n.compose,a=n.data,i=n.onTerminate,c=void 0===a.configure||a.configure,"konnector"!==r.type||!c){t.next=7;break}return t.next=7,o("CREATE","io.cozy.accounts",{slug:r.slug});case 7:i(e.app);case 8:case"end":return t.stop()}},t,this)}),l=function(){var t=this,e=arguments;return new Promise(function(n,r){var o=c.apply(t,e);function a(t){j(o,n,r,a,i,"next",t)}function i(t){j(o,n,r,a,i,"throw",t)}a(void 0)})},function(t){return l.apply(this,arguments)})},{key:"render",value:function(){var t=this,e=this.props,n=e.app,r=e.appData,o=e.fetchError,i=e.installError,c=e.isFetching,l=e.isAppFetching,s=e.isInstalling,p=e.onCancel,f=e.t,y=c||l,b=!o&&!y&&!l,d="installed"===this.state.status,h=b&&!n,m={alreadyInstalledError:!d&&n&&n.installed,fetchError:o,installError:i,appError:h},v=Object.keys(m).reduce(function(t,e){return m[e]?x[e]:t},null),O=!!v&&new Error(f(v));return a.a.createElement("div",{className:"coz-intent-wrapper"},a.a.createElement(E.a,{appEditor:r.cozyAppEditor,appName:r.cozyAppName,appIcon:"../".concat(r.cozyIconPath)}),a.a.createElement("div",{className:"coz-intent-content"},y&&a.a.createElement(u.a,{size:"xxlarge"}),O&&a.a.createElement("div",{className:"coz-error"},O.message),b&&!d&&!O&&a.a.createElement(g.a,{appSlug:n.slug,installApp:function(){return t.installApp()},isInstalling:s,onCancel:p})))}}])&&S(n.prototype,r),i&&S(n,i),e}(),I=Object(l.e)()(Object(r.b)(function(t,e){return{isFetching:t.apps.isFetching,isAppFetching:t.apps.isAppFetching,isInstalling:t.apps.isInstalling,installError:t.apps.actionError,fetchError:t.apps.fetchError,app:Object(O.f)(t,e.data.slug)}},function(t,e){return{initAppIntent:function(){t(Object(O.k)(e.lang,e.data.slug))},installApp:function(e,n,r){return t(Object(O.l)(e,n,r))}}})(k));document.addEventListener("DOMContentLoaded",function(){var t=document.querySelector("[role=application]").dataset;cozy.client.init({cozyURL:"//"+t.cozyDomain,token:t.cozyToken}),Object(i.render)(a.a.createElement(l.c,{lang:t.cozyLocale,dictRequire:function(t){return n("/KVF")("./".concat(t))}},a.a.createElement(r.a,{store:c.a},a.a.createElement(h,{appData:t,intents:cozy.client.intents},a.a.createElement(I,{action:"INSTALL",type:"io.cozy.apps"})))),document.querySelector("[role=application]"))})}});